<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–™é‡‘è¨ˆç®—ãƒ»å¥‘ç´„ãƒ•ã‚©ãƒ¼ãƒ </title>
  <!-- Reacté–¢é€£ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background-color: #f5f5f5;
    }
    #app-container {
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }
    .active-section {
      background-color: #FCF7DE;
    }
    .inactive-section {
      background-color: #e0e0e0;
      opacity: 0.6;
      pointer-events: none;
    }
    .process-active {
      background-color: #cfe2f3ff;
    }
    .process-inactive {
      background-color: #e0e0e0;
      opacity: 0.6;
    }
    .primary-button {
      background-color: #F58220;
      color: white;
    }
    .primary-button:hover {
      background-color: #d66d0a;
    }
    .qr-placeholder {
      width: 300px;
      height: 300px;
      border: 2px dashed #666;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <div id="app-container"></div>
  
  <script type="text/babel">
    const App = () => {
      // æ–™é‡‘ãƒ—ãƒ©ãƒ³è¨­å®š
      const feeTable = {
        "ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ": {
          "æœˆ2å›": 10980,
          "æœˆ3å›": 15470,
          "æœˆ4å›": 19960,
          "æœˆ6å›": 29940
        },
        "å¹³æ—¥ãƒ•ãƒ«": {
          "æœˆ2å›": 9800,
          "æœˆ3å›": 13700,
          "æœˆ4å›": 17600,
          "æœˆ6å›": 26400
        },
        "ã„ã¤ã§ã‚‚å¤•æ–¹": {
          "æœˆ2å›": 8690,
          "æœˆ3å›": 12035,
          "æœˆ4å›": 15380,
          "æœˆ6å›": 23070
        }
      };

      // çŠ¶æ…‹ç®¡ç†
      const [currentStep, setCurrentStep] = React.useState(1);
      const [plan, setPlan] = React.useState("");
      const [frequency, setFrequency] = React.useState("");
      const [nextMonthPlan, setNextMonthPlan] = React.useState("");
      const [nextMonthFrequency, setNextMonthFrequency] = React.useState("");
      const [joinAtTrial, setJoinAtTrial] = React.useState(true);
      const [startTiming, setStartTiming] = React.useState("ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹");
      const [changePlanNextMonth, setChangePlanNextMonth] = React.useState(false);
      const [showPlanChangeForm, setShowPlanChangeForm] = React.useState(false);
      
      // é‡‘é¡è¨ˆç®—
      const [thisMonthFee, setThisMonthFee] = React.useState(0);
      const [nextMonthFee, setNextMonthFee] = React.useState(0);
      const [registrationFee, setRegistrationFee] = React.useState(5950);
      const [thisMonthTotal, setThisMonthTotal] = React.useState(0);
      const [nextMonthTotal, setNextMonthTotal] = React.useState(0);

      // æ—¥ä»˜é–¢é€£
      const today = new Date();
      const nextMonth = new Date(today.getFullYear(), today.getMonth() + 1, 1);
      
      const formatDate = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        return `${year}å¹´${month}æœˆ${day}æ—¥`;
      };

      // åˆ©ç”¨é–‹å§‹æ—¥ã®è¨ˆç®—
      const getStartDate = () => {
        if (startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹") {
          return formatDate(today);
        } else {
          return formatDate(nextMonth);
        }
      };

      // å¼•è½é–‹å§‹æ—¥ï¼ˆæ¥æœˆ1æ—¥ï¼‰
      const getPaymentStartDate = () => {
        return formatDate(nextMonth);
      };

      // é‡‘é¡ã‚’å†è¨ˆç®—
      React.useEffect(() => {
        if (!plan || !frequency) {
          setThisMonthFee(0);
          setNextMonthFee(0);
          setThisMonthTotal(joinAtTrial ? registrationFee - 1000 : registrationFee);
          setNextMonthTotal(0);
          return;
        }
        
        const monthlyFee = feeTable[plan][frequency];
        const discountedRegistrationFee = joinAtTrial ? registrationFee - 1000 : registrationFee;
        
        if (startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹") {
          setThisMonthFee(monthlyFee);
          // æ¥æœˆã®ãƒ—ãƒ©ãƒ³ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã¡ã‚‰ã‚’ä½¿ç”¨
          if (changePlanNextMonth && nextMonthPlan && nextMonthFrequency) {
            setNextMonthFee(feeTable[nextMonthPlan][nextMonthFrequency]);
          } else {
            setNextMonthFee(monthlyFee);
          }
          setThisMonthTotal(discountedRegistrationFee + monthlyFee);
        } else {
          setThisMonthFee(0);
          setNextMonthFee(monthlyFee);
          setThisMonthTotal(discountedRegistrationFee);
        }
        
        // æ¥æœˆä»¥é™ã®åˆè¨ˆã¯æœˆè¬ã®ã¿
        setNextMonthTotal(nextMonthFee);
      }, [plan, frequency, joinAtTrial, startTiming, changePlanNextMonth, nextMonthPlan, nextMonthFrequency, nextMonthFee]);

      // â‘¢ãŠä¼šè¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ°é”æ™‚ã«éŸ³ã‚’é³´ã‚‰ã™
      React.useEffect(() => {
        if (currentStep === 3) {
          // MP3ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç”Ÿ
          const audio = new Audio('./å‘¼ã³å‡ºã—éŸ³.mp3');
          audio.volume = 0.5; // éŸ³é‡èª¿æ•´ï¼ˆ0ã€œ1ï¼‰
          audio.play().catch(error => {
            console.log('éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
          });
        }
      }, [currentStep]);

      // QRã‚³ãƒ¼ãƒ‰ç”»åƒã®ãƒ‘ã‚¹ã‚’ç”Ÿæˆ
      const getQRImagePath = () => {
        const planMap = {
          "ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ": "fulltime",
          "å¹³æ—¥ãƒ•ãƒ«": "weekday",
          "ã„ã¤ã§ã‚‚å¤•æ–¹": "evening"
        };
        const frequencyMap = {
          "æœˆ2å›": "2",
          "æœˆ3å›": "3",
          "æœˆ4å›": "4",
          "æœˆ6å›": "6"
        };
        
        // æ¥æœˆã®ãƒ—ãƒ©ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã¡ã‚‰ã‚’ä½¿ç”¨
        const targetPlan = (changePlanNextMonth && nextMonthPlan) ? nextMonthPlan : plan;
        const targetFrequency = (changePlanNextMonth && nextMonthFrequency) ? nextMonthFrequency : frequency;
        
        if (targetPlan && targetFrequency) {
          const datePrefix = "20250603"; // ä¾¡æ ¼æ”¹å®šæ™‚ã¯ã“ã“ã‚’å¤‰æ›´
          const path = `./images/${datePrefix}-${planMap[targetPlan]}-${frequencyMap[targetFrequency]}.png`;
          console.log("ç”»åƒãƒ‘ã‚¹:", path); // ãƒ‡ãƒãƒƒã‚°ç”¨
          return path;
        }
        return "";
      };

      // QRã‚³ãƒ¼ãƒ‰ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ
      const getQRPlaceholderText = () => {
        const targetPlan = (changePlanNextMonth && nextMonthPlan) ? nextMonthPlan : plan;
        const targetFrequency = (changePlanNextMonth && nextMonthFrequency) ? nextMonthFrequency : frequency;
        return `${targetPlan}\n${targetFrequency}\nQRã‚³ãƒ¼ãƒ‰`;
      };

      return (
        <div className="h-screen flex flex-col bg-gray-100">
          {/* ãƒ—ãƒ­ã‚»ã‚¹è¡¨ç¤ºéƒ¨åˆ† */}
          <div className="bg-white shadow-md p-4">
            <div className="flex justify-center items-center space-x-2">
              <div className={`px-4 py-2 rounded-lg font-bold text-sm ${currentStep === 1 ? 'process-active' : 'process-inactive'}`}>
                â‘ ãƒ—ãƒ©ãƒ³æ±ºã‚
              </div>
              <div className="text-xl">â†’</div>
              <div className={`px-4 py-2 rounded-lg font-bold text-sm ${currentStep === 2 ? 'process-active' : 'process-inactive'}`}>
                â‘¡ç¢ºèªæ›¸
              </div>
              {showPlanChangeForm && (
                <>
                  <div className="text-xl">â†’</div>
                  <div className={`px-4 py-2 rounded-lg font-bold text-sm ${currentStep === 2.5 ? 'process-active' : 'process-inactive'}`}>
                    â‘¡-2ãƒ—ãƒ©ãƒ³å¤‰æ›´å±Š
                  </div>
                </>
              )}
              <div className="text-xl">â†’</div>
              <div className={`px-4 py-2 rounded-lg font-bold text-sm ${currentStep === 3 ? 'process-active' : 'process-inactive'}`}>
                â‘¢ãŠä¼šè¨ˆ
              </div>
              <div className="text-xl">â†’</div>
              <div className={`px-4 py-2 rounded-lg font-bold text-sm ${currentStep === 4 ? 'process-active' : 'process-inactive'}`}>
                â‘£å¼•ãè½ã¨ã—ç™»éŒ²
              </div>
              <div className="text-xl">â†’</div>
              <div className="px-4 py-2 rounded-lg font-bold text-sm process-inactive">
                â‘¤å®Œäº†
              </div>
            </div>
          </div>

          {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
          <div className="flex-1 p-4 lg:p-8 overflow-auto">
            <div className="max-w-7xl mx-auto space-y-6">
              
              {/* â‘ ãƒ—ãƒ©ãƒ³æ±ºã‚ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
              <div id="section-1" className={`p-6 rounded-lg shadow-lg ${currentStep === 1 ? 'active-section' : 'inactive-section'}`}>
                <h2 className="text-2xl font-bold mb-6 text-center">â‘ ãƒ—ãƒ©ãƒ³ã‚’æ±ºã‚ã‚ˆã†</h2>
                
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                  {/* å·¦å´ï¼šå…¥åŠ› */}
                  <div className="space-y-4">
                    {/* ä»Šæœˆã®ãƒ—ãƒ©ãƒ³é¸æŠã‚¨ãƒªã‚¢ */}
                    <div className={changePlanNextMonth ? 'bg-white p-4 rounded-lg' : ''}>
                      <div>
                        <label className="block mb-2 font-medium text-lg">
                          {changePlanNextMonth ? 'ä»Šæœˆã®ãƒ—ãƒ©ãƒ³' : 'ãƒ—ãƒ©ãƒ³'}
                        </label>
                        <select 
                          className="w-full p-3 border rounded text-lg"
                          value={plan}
                          onChange={(e) => setPlan(e.target.value)}
                          disabled={currentStep !== 1}
                        >
                          <option value="" disabled>ãƒ—ãƒ©ãƒ³ã‚’é¸ã‚“ã§ãã ã•ã„</option>
                          <option value="ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ">ãƒ•ãƒ«ã‚¿ã‚¤ãƒ </option>
                          <option value="å¹³æ—¥ãƒ•ãƒ«">å¹³æ—¥ãƒ•ãƒ«</option>
                          <option value="ã„ã¤ã§ã‚‚å¤•æ–¹">ã„ã¤ã§ã‚‚å¤•æ–¹</option>
                        </select>
                      </div>
                      
                      <div className="mt-4">
                        <label className="block mb-2 font-medium text-lg">
                          {changePlanNextMonth ? 'ä»Šæœˆã®å›æ•°' : 'å›æ•°'}
                        </label>
                        <select 
                          className="w-full p-3 border rounded text-lg"
                          value={frequency}
                          onChange={(e) => setFrequency(e.target.value)}
                          disabled={currentStep !== 1}
                        >
                          <option value="" disabled>å›æ•°ã‚’é¸ã‚“ã§ãã ã•ã„</option>
                          <option value="æœˆ2å›">æœˆ2å›</option>
                          <option value="æœˆ3å›">æœˆ3å›</option>
                          <option value="æœˆ4å›">æœˆ4å›</option>
                          <option value="æœˆ6å›">æœˆ6å›</option>
                        </select>
                      </div>
                    </div>
                    
                    <div className="flex items-center">
                      <input 
                        type="checkbox" 
                        id="joinAtTrial" 
                        className="mr-3 h-5 w-5"
                        checked={joinAtTrial}
                        onChange={(e) => setJoinAtTrial(e.target.checked)}
                        disabled={currentStep !== 1}
                      />
                      <label htmlFor="joinAtTrial" className="text-lg">ä½“é¨“æ™‚ã«å…¥ä¼š</label>
                    </div>
                    
                    <div className="space-y-3">
                      <div className="flex items-center">
                        <input 
                          type="radio" 
                          id="startThisMonth" 
                          name="startTiming"
                          className="mr-3 h-5 w-5"
                          value="ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹"
                          checked={startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹"}
                          onChange={(e) => setStartTiming(e.target.value)}
                          disabled={currentStep !== 1}
                        />
                        <label htmlFor="startThisMonth" className="text-lg">ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹</label>
                      </div>
                      
                      {startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹" && (
                        <div className="flex items-center ml-8">
                          <input 
                            type="checkbox" 
                            id="changePlanNextMonth" 
                            className="mr-3 h-5 w-5"
                            checked={changePlanNextMonth}
                            onChange={(e) => setChangePlanNextMonth(e.target.checked)}
                            disabled={currentStep !== 1}
                          />
                          <label htmlFor="changePlanNextMonth" className="text-lg">ä»Šæœˆã¨æ¥æœˆã§ãƒ—ãƒ©ãƒ³ã‚’å¤‰ãˆã‚‹</label>
                        </div>
                      )}
                      
                      <div className="flex items-center">
                        <input 
                          type="radio" 
                          id="startNextMonth" 
                          name="startTiming"
                          className="mr-3 h-5 w-5"
                          value="æ¥æœˆã‹ã‚‰å§‹ã‚ã‚‹"
                          checked={startTiming === "æ¥æœˆã‹ã‚‰å§‹ã‚ã‚‹"}
                          onChange={(e) => setStartTiming(e.target.value)}
                          disabled={currentStep !== 1}
                        />
                        <label htmlFor="startNextMonth" className="text-lg">æ¥æœˆã‹ã‚‰å§‹ã‚ã‚‹</label>
                      </div>
                    </div>
                    
                    {/* æ¥æœˆã®ãƒ—ãƒ©ãƒ³é¸æŠã‚¨ãƒªã‚¢ */}
                    {changePlanNextMonth && startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹" && (
                      <div className="bg-white p-4 rounded-lg mt-4">
                        <div>
                          <label className="block mb-2 font-medium text-lg">æ¥æœˆã®ãƒ—ãƒ©ãƒ³</label>
                          <select 
                            className="w-full p-3 border rounded text-lg"
                            value={nextMonthPlan}
                            onChange={(e) => setNextMonthPlan(e.target.value)}
                            disabled={currentStep !== 1}
                          >
                            <option value="" disabled>ãƒ—ãƒ©ãƒ³ã‚’é¸ã‚“ã§ãã ã•ã„</option>
                            <option value="ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ">ãƒ•ãƒ«ã‚¿ã‚¤ãƒ </option>
                            <option value="å¹³æ—¥ãƒ•ãƒ«">å¹³æ—¥ãƒ•ãƒ«</option>
                            <option value="ã„ã¤ã§ã‚‚å¤•æ–¹">ã„ã¤ã§ã‚‚å¤•æ–¹</option>
                          </select>
                        </div>
                        
                        <div className="mt-4">
                          <label className="block mb-2 font-medium text-lg">æ¥æœˆã®å›æ•°</label>
                          <select 
                            className="w-full p-3 border rounded text-lg"
                            value={nextMonthFrequency}
                            onChange={(e) => setNextMonthFrequency(e.target.value)}
                            disabled={currentStep !== 1}
                          >
                            <option value="" disabled>å›æ•°ã‚’é¸ã‚“ã§ãã ã•ã„</option>
                            <option value="æœˆ2å›">æœˆ2å›</option>
                            <option value="æœˆ3å›">æœˆ3å›</option>
                            <option value="æœˆ4å›">æœˆ4å›</option>
                            <option value="æœˆ6å›">æœˆ6å›</option>
                          </select>
                        </div>
                      </div>
                    )}
                  </div>
                  
                  {/* å³å´ï¼šè¨ˆç®—çµæœ */}
                  <div className="space-y-4">
                    <h3 className="font-bold text-xl border-b pb-2">ä»Šæœˆã®è²»ç”¨</h3>
                    <div className="flex justify-between items-baseline text-lg">
                      <span>å…¥ä¼šè²»</span>
                      <span>{(joinAtTrial ? registrationFee - 1000 : registrationFee).toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    <div className="flex justify-between items-baseline text-lg">
                      <span>æœˆè¬</span>
                      <span>{thisMonthFee.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    <div className="flex justify-between items-baseline font-bold text-xl border-t pt-2">
                      <span>ä»Šæœˆåˆè¨ˆ</span>
                      <span>{thisMonthTotal.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    
                    <h3 className={`font-bold text-xl border-b pb-2 ${changePlanNextMonth && startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹" ? 'mt-32' : 'mt-6'}`}>æ¥æœˆä»¥é™ã®è²»ç”¨</h3>
                    <div className="flex justify-between items-baseline text-lg">
                      <span>æœˆè¬</span>
                      <span>{nextMonthFee.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    <div className="flex justify-between items-baseline font-bold text-xl border-t pt-2">
                      <span>æ¥æœˆåˆè¨ˆ</span>
                      <span>{nextMonthTotal.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                  </div>
                </div>
                
                <div className="mt-8 flex justify-between">
                  <button 
                    className="primary-button px-8 py-4 rounded-lg text-xl font-bold disabled:opacity-50"
                    onClick={() => {
                      setCurrentStep(2);
                      setTimeout(() => {
                        document.getElementById('section-2')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                      }, 100);
                    }}
                    disabled={!plan || !frequency || (changePlanNextMonth && (!nextMonthPlan || !nextMonthFrequency))}
                  >
                    ãƒ—ãƒ©ãƒ³ç¢ºå®šï¼ˆæ¬¡ã¸ï¼‰
                  </button>
                </div>
              </div>

              {/* â‘¡ç¢ºèªæ›¸ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
              <div id="section-2" className={`p-6 rounded-lg shadow-lg ${currentStep === 2 ? 'active-section' : 'inactive-section'}`}>
                <h2 className="text-2xl font-bold mb-6 text-center">â‘¡ç¢ºèªæ›¸ã‚’æ›¸ã“ã†</h2>
                
                <div className="max-w-2xl mx-auto space-y-6">
                  <div className="bg-white p-6 rounded-lg space-y-4">
                    <div className="flex items-center space-x-4">
                      <span className="font-medium text-lg">ãƒ—ãƒ©ãƒ³åï¼š</span>
                      <span className="text-xl font-bold text-red-600 border-2 border-red-600 rounded-full px-4 py-1">
                        {plan || "æœªé¸æŠ"}
                      </span>
                    </div>
                    
                    <div className="flex items-center space-x-4">
                      <span className="font-medium text-lg">å›æ•°ï¼š</span>
                      <span className="text-xl font-bold text-red-600 border-2 border-red-600 rounded-full px-4 py-1">
                        {frequency || "æœªé¸æŠ"}
                      </span>
                    </div>
                    
                    <div className="flex items-center space-x-4">
                      <span className="font-medium text-lg">åˆ©ç”¨é–‹å§‹æ—¥ï¼š</span>
                      <span className="text-xl font-bold">{getStartDate()}</span>
                    </div>
                    
                    <div className="flex items-center space-x-4">
                      <span className="font-medium text-lg">å¼•è½é–‹å§‹æ—¥ï¼š</span>
                      <span className="text-xl font-bold">{getPaymentStartDate()}</span>
                    </div>
                    
                    <div className="space-y-2">
                      {changePlanNextMonth && nextMonthPlan && nextMonthFrequency ? (
                        <>
                          <div className="flex items-center space-x-4">
                            <span className="font-medium text-lg">æœˆè¬ï¼ˆä»Šæœˆï¼‰ï¼š</span>
                            <span className="text-xl font-bold">
                              {thisMonthFee.toLocaleString()}å††
                            </span>
                          </div>
                          <div className="flex items-center space-x-4">
                            <span className="font-medium text-lg">æœˆè¬ï¼ˆæ¥æœˆä»¥é™ï¼‰ï¼š</span>
                            <span className="text-xl font-bold">
                              {nextMonthFee.toLocaleString()}å††
                            </span>
                          </div>
                        </>
                      ) : (
                        <div className="flex items-center space-x-4">
                          <span className="font-medium text-lg">æœˆé¡ï¼š</span>
                          <span className="text-xl font-bold">
                            {(plan && frequency) ? feeTable[plan][frequency].toLocaleString() : 0}å††
                          </span>
                        </div>
                      )}
                    </div>
                  </div>
                  
                  <div className="text-center text-lg font-medium text-gray-700 mt-6">
                    â‘¡ç¢ºèªäº‹é …ã¨â‘¢ã”ç½²åã¾ã§è¨˜å…¥ã‚’ãŠé¡˜ã„ã—ã¾ã™
                  </div>
                  
                  <div className="flex justify-between mt-8">
                    <button 
                      className="px-6 py-3 bg-gray-500 text-white rounded-lg text-lg font-bold hover:bg-gray-600"
                      onClick={() => {
                        setCurrentStep(1);
                        setTimeout(() => {
                          document.getElementById('section-1')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                      }}
                    >
                      æˆ»ã‚‹
                    </button>
                    <button 
                      className="primary-button px-6 py-3 rounded-lg text-lg font-bold"
                      onClick={() => {
                        console.log('ç¢ºèªæ›¸ã®æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯');
                        // ãƒ—ãƒ©ãƒ³å¤‰æ›´ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                        const hasChange = changePlanNextMonth && startTiming === "ä»Šæœˆã‹ã‚‰å§‹ã‚ã‚‹" && plan && frequency && nextMonthPlan && nextMonthFrequency;
                        console.log('ãƒ—ãƒ©ãƒ³å¤‰æ›´ã‚ã‚Šï¼Ÿ:', hasChange);
                        
                        if (hasChange) {
                          setCurrentStep(2.5);
                          setTimeout(() => {
                            document.getElementById('section-2-5')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                          }, 100);
                        } else {
                          setCurrentStep(3);
                          setTimeout(() => {
                            document.getElementById('section-3')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                          }, 100);
                        }
                      }}
                    >
                      æ¬¡ã¸
                    </button>
                  </div>
                </div>
              </div>

              {/* â‘¡-2ãƒ—ãƒ©ãƒ³å¤‰æ›´å±Šã‚»ã‚¯ã‚·ãƒ§ãƒ³ - å¸¸ã«è¡¨ç¤ºã—ã¦ãƒ†ã‚¹ãƒˆ */}
              <div id="section-2-5" className={`p-6 rounded-lg shadow-lg ${currentStep === 2.5 ? 'active-section' : 'inactive-section'}`}>
                  <h2 className="text-2xl font-bold mb-6 text-center">ãƒ—ãƒ©ãƒ³å¤‰æ›´å±Šã‚’æ›¸ã“ã†</h2>
                  {console.log('ãƒ—ãƒ©ãƒ³å¤‰æ›´å±Šè¡¨ç¤ºä¸­, currentStep:', currentStep, 'showPlanChangeForm:', showPlanChangeForm)}
                  
                  <div className="max-w-2xl mx-auto space-y-6">
                    <div className="text-gray-700 space-y-2 mb-4">
                      <p>â‘ ãŠåå‰ã€ç”Ÿå¹´æœˆæ—¥ã€é›»è©±ç•ªå·ã‚’ã”è¨˜å…¥ãã ã•ã„</p>
                      <p>â‘¡ç¢ºèªäº‹é …ã‚’ãŠèª­ã¿ã«ãªã‚Šã€â–¡ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„</p>
                    </div>
                    
                    <div className="bg-white p-6 rounded-lg space-y-4">
                      <h3 className="text-xl font-bold mb-4">â‘¢</h3>
                      
                      <div className="space-y-3">
                        <div className="flex items-center space-x-4">
                          <span className="font-medium">ç”³è¾¼æ—¥ï¼š</span>
                          <span className="font-bold">{formatDate(today)}</span>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                          <span className="font-medium">å¤‰æ›´å‰ã®ãƒ—ãƒ©ãƒ³ï¼š</span>
                          <span className="font-bold">{plan} {frequency}</span>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                          <span className="font-medium">å¤‰æ›´å¾Œã®ãƒ—ãƒ©ãƒ³ï¼š</span>
                          <span className="font-bold">{nextMonthPlan} {nextMonthFrequency}</span>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                          <span className="font-medium">å¤‰æ›´é©ç”¨æ—¥ï¼š</span>
                          <span className="font-bold">{formatDate(nextMonth)}</span>
                        </div>
                      </div>
                    </div>
                    
                    <div className="flex justify-between mt-8">
                      <button 
                        className="px-6 py-3 bg-gray-500 text-white rounded-lg text-lg font-bold hover:bg-gray-600"
                        onClick={() => {
                          setCurrentStep(2);
                          setTimeout(() => {
                            document.getElementById('section-2')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                          }, 100);
                        }}
                      >
                        æˆ»ã‚‹
                      </button>
                      <button 
                        className="primary-button px-6 py-3 rounded-lg text-lg font-bold"
                        onClick={() => {
                          setCurrentStep(3);
                          setTimeout(() => {
                            document.getElementById('section-3')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                          }, 100);
                        }}
                      >
                        æ¬¡ã¸
                      </button>
                    </div>
                  </div>
                </div>
              )}

              {/* â‘¢ãŠä¼šè¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
              <div id="section-3" className={`p-6 rounded-lg shadow-lg ${currentStep === 3 ? 'active-section' : 'inactive-section'}`}>
                <h2 className="text-2xl font-bold mb-2 text-center">â‘¢ä»Šæœˆã®ãŠä¼šè¨ˆã‚’ã—ã‚ˆã†</h2>
                <p className="text-center text-lg text-gray-700 mb-6">å…ˆç”Ÿã‚’å‘¼ã‚“ã§ã­</p>
                
                <div className="max-w-2xl mx-auto">
                  <div className="bg-white p-6 rounded-lg space-y-4">
                    <h3 className="font-bold text-xl border-b pb-2">ä»Šæœˆã®è²»ç”¨</h3>
                    <div className="flex justify-between items-baseline text-lg">
                      <span>å…¥ä¼šè²»</span>
                      <span>{(joinAtTrial ? registrationFee - 1000 : registrationFee).toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    <div className="flex justify-between items-baseline text-lg">
                      <span>æœˆè¬</span>
                      <span>{thisMonthFee.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                    <div className="flex justify-between items-baseline font-bold text-xl border-t pt-2">
                      <span>ä»Šæœˆåˆè¨ˆ</span>
                      <span>{thisMonthTotal.toLocaleString()}<span className="text-sm">å††</span></span>
                    </div>
                  </div>
                  
                  <div className="flex items-center justify-between mt-8">
                    <button 
                      className="px-6 py-3 bg-gray-500 text-white rounded-lg text-lg font-bold hover:bg-gray-600"
                      onClick={() => {
                        const prevStep = showPlanChangeForm ? 2.5 : 2;
                        setCurrentStep(prevStep);
                        setTimeout(() => {
                          const sectionId = showPlanChangeForm ? 'section-2-5' : 'section-2';
                          document.getElementById(sectionId)?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                      }}
                    >
                      æˆ»ã‚‹
                    </button>
                    <div className="flex items-center space-x-4">
                      <div className="text-right">
                        <p className="text-sm font-medium text-gray-700">ä»Šæœˆåˆ†ãƒ»ãƒ»ãƒ»<span style={{color: '#10B981'}}>OKï¼</span><span>âœ…</span></p>
                        <p className="text-sm font-medium text-gray-700">æ¥æœˆä»¥é™ãƒ»ãƒ»ãƒ»â†’</p>
                      </div>
                      <button 
                        className="primary-button px-6 py-3 rounded-lg text-lg font-bold"
                        onClick={() => {
                          setCurrentStep(4);
                          setTimeout(() => {
                            document.getElementById('section-4')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                          }, 100);
                        }}
                      >
                        æ¬¡ã¸
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              {/* â‘£å¼•ãè½ã¨ã—ç™»éŒ²ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
              <div id="section-4" className={`p-6 rounded-lg shadow-lg ${currentStep === 4 ? 'active-section' : 'inactive-section'}`}>
                <h2 className="text-2xl font-bold mb-6 text-center">â‘£æ¥æœˆã®å¼•ãè½ã¨ã—ç™»éŒ²</h2>
                
                <div className="flex flex-col items-center space-y-6">
                  {(changePlanNextMonth ? (nextMonthPlan && nextMonthFrequency) : (plan && frequency)) ? (
                    <img 
                      src={getQRImagePath()} 
                      alt={`${changePlanNextMonth ? nextMonthPlan : plan} ${changePlanNextMonth ? nextMonthFrequency : frequency} QRã‚³ãƒ¼ãƒ‰`}
                      style={{ 
                        width: "300px", 
                        height: "300px", 
                        objectFit: "contain",
                        border: "1px solid #ddd" 
                      }}
                      onError={(e) => {
                        console.error("ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", e.target.src);
                        e.target.style.display = 'none';
                        e.target.nextSibling.style.display = 'flex';
                      }}
                    />
                  ) : null}
                  <div 
                    className="qr-placeholder" 
                    style={{ 
                      display: (changePlanNextMonth ? (nextMonthPlan && nextMonthFrequency) : (plan && frequency)) ? 'none' : 'flex',
                      width: "300px",
                      height: "300px"
                    }}
                  >
                    <div className="text-center">
                      <p className="text-sm">{getQRPlaceholderText()}</p>
                    </div>
                  </div>
                  
                  <div className="text-xl font-medium">
                    ã”è‡ªèº«ã®ã‚¹ãƒãƒ›ã§ğŸ‘†ã®QRã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã£ã¦ã­ï¼
                  </div>
                  
                  <div className="flex justify-between mt-8">
                    <button 
                      className="px-6 py-3 bg-gray-500 text-white rounded-lg text-lg font-bold hover:bg-gray-600"
                      onClick={() => {
                        setCurrentStep(3);
                        setTimeout(() => {
                          document.getElementById('section-3')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                      }}
                    >
                      æˆ»ã‚‹
                    </button>
                    <button 
                      className="primary-button px-6 py-3 rounded-lg text-lg font-bold"
                      onClick={() => window.location.href = 'https://docs.google.com/presentation/d/1Gs0pot3LOPsm4jWxTZMrTJTfiLsSv0snkms8wMlmvyc/present?slide=id.g35e05055ccb_2_27#slide=id.g35e05055ccb_2_27'}
                    >
                      æ¬¡ã¸ï¼ˆæ“ä½œæ–¹æ³•ï¼‰
                    </button>
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        </div>
      );
    };

    // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    ReactDOM.render(
      <App />,
      document.getElementById('app-container')
    );
  </script>
</body>
</html>
